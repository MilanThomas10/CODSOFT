<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculator</title>
  <style>
    :root{
      --bg:#f3f4f6;
      --panel:#ffffff;
      --accent:#3b82f6;
      --muted:#6b7280;
      --shadow:0 6px 18px rgba(15,23,42,0.08);
    }
    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#eef2ff 0%,var(--bg)100%);display:flex;align-items:center;justify-content:center;padding:24px}
    .calculator{width:360px;background:var(--panel);border-radius:16px;box-shadow:var(--shadow);overflow:hidden}
    .screen{padding:20px;background:linear-gradient(180deg,#fff,#fbfdff);display:flex;flex-direction:column;gap:8px}
    .history{font-size:14px;color:var(--muted);min-height:18px;text-align:right;word-break:break-all}
    .output{font-size:32px;font-weight:600;text-align:right;min-height:40px;word-break:break-all}
    .pad{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;padding:20px;background:var(--bg)}
    button{height:56px;border-radius:10px;border:0;font-size:18px;cursor:pointer;outline:none}
    .btn-ops{background:#eef2ff;color:var(--accent);font-weight:600}
    .btn-eq{grid-column:span 2;background:var(--accent);color:#fff;font-weight:700}
    .btn-fn{background:#f8fafc;color:#111}
    .btn-num{background:#fff;color:#111;box-shadow:0 2px 6px rgba(11,22,44,0.05)}
    .kbd-hint{font-size:12px;color:var(--muted);padding:10px 18px;text-align:center;background:transparent}
    @media (max-width:420px){.calculator{width:100%}}
  </style>
</head>
<body>
  <div class="calculator" role="application" aria-label="Basic Calculator">
    <div class="screen">
      <div class="history" id="history"></div>
      <div class="output" id="display">0</div>
    </div>
    <div class="pad" id="pad">
      <button class="btn-fn" data-action="clear">C</button>
      <button class="btn-fn" data-action="back">⌫</button>
      <button class="btn-fn" data-action="sign">±</button>
      <button class="btn-ops" data-value="÷">÷</button>

      <button class="btn-num" data-value="7">7</button>
      <button class="btn-num" data-value="8">8</button>
      <button class="btn-num" data-value="9">9</button>
      <button class="btn-ops" data-value="×">×</button>

      <button class="btn-num" data-value="4">4</button>
      <button class="btn-num" data-value="5">5</button>
      <button class="btn-num" data-value="6">6</button>
      <button class="btn-ops" data-value="-">-</button>

      <button class="btn-num" data-value="1">1</button>
      <button class="btn-num" data-value="2">2</button>
      <button class="btn-num" data-value="3">3</button>
      <button class="btn-ops" data-value="+">+</button>

      <button class="btn-num" data-value="0" style="grid-column:span 2;text-align:left;padding-left:24px">0</button>
      <button class="btn-num" data-value=".">.</button>
      <button class="btn-eq" data-action="equals">=</button>
    
  <script>
    const display = document.getElementById('display')
    const history = document.getElementById('history')
    const pad = document.getElementById('pad')
    let expr = ''
    let lastResult = null

    function updateDisplay(){
      display.textContent = expr === '' ? '0' : expr
    }

    function appendValue(v){
      const ops = ['+','-','×','÷']
      if(v === '.'){
        const parts = expr.split(/[\+\-\×\÷]/)
        if(parts[parts.length-1].includes('.')) return
        if(parts[parts.length-1] === '') expr += '0'
        expr += '.'
        updateDisplay()
        return
      }
      if(ops.includes(v)){
        if(expr === '' && v === '-') { expr = '-' ; updateDisplay(); return }
        if(expr === '') return
        if(ops.includes(expr.slice(-1))){
          expr = expr.slice(0,-1) + v
        } else {
          expr += v
        }
        updateDisplay()
        return
      }
      if(expr === '0') expr = v
      else expr += v
      updateDisplay()
    }

    function clearAll(){
      expr = ''
      lastResult = null
      history.textContent = ''
      updateDisplay()
    }

    function backspace(){
      if(expr.length > 0) expr = expr.slice(0,-1)
      updateDisplay()
    }

    function toggleSign(){
      if(expr === '') return
      const ops = ['+','-','×','÷']
      let i = -1
      for(let j = expr.length - 1; j >= 0; j--){
        if(ops.includes(expr[j]) && j !== 0){ i = j; break }
      }
      if(i === -1){
        if(expr.startsWith('-')) expr = expr.slice(1)
        else expr = '-' + expr
      } else {
        const left = expr.slice(0, i+1)
        let right = expr.slice(i+1)
        if(right.startsWith('-')) right = right.slice(1)
        else right = '-' + right
        expr = left + right
      }
      updateDisplay()
    }

    function safeEval(s){
      s = s.replace(/×/g,'*').replace(/÷/g,'/')
      if(/[^0-9+\-*/.() ]/.test(s)) throw new Error('Invalid')
      return Function('"use strict";return (' + s + ')')()
    }

    function compute(){
      if(expr === '') return
      let temp = expr
      while(/[\+\-\×\÷]$/.test(temp)) temp = temp.slice(0,-1)
      try{
        const result = safeEval(temp)
        history.textContent = temp + ' ='
        expr = String(Number.isFinite(result) ? +result : '0')
        lastResult = expr
        updateDisplay()
      } catch(e){
        display.textContent = 'Error'
        expr = ''
      }
    }

    pad.addEventListener('click', e => {
      const t = e.target
      if(!t.matches('button')) return
      const v = t.getAttribute('data-value')
      const action = t.getAttribute('data-action')
      if(action === 'clear') clearAll()
      else if(action === 'back') backspace()
      else if(action === 'sign') toggleSign()
      else if(action === 'equals') compute()
      else if(v) appendValue(v)
    })

    window.addEventListener('keydown', e => {
      if(e.key >= '0' && e.key <= '9'){ appendValue(e.key); e.preventDefault(); return }
      if(e.key === '.' ) { appendValue('.'); e.preventDefault(); return }
      if(e.key === '+' || e.key === '-' || e.key === '*' || e.key === '/'){
        const map = {'*':'×','/':'÷'}
        appendValue(map[e.key] || e.key)
        e.preventDefault()
        return
      }
      if(e.key === 'Enter'){ compute(); e.preventDefault(); return }
      if(e.key === 'Backspace'){ backspace(); e.preventDefault(); return }
      if(e.key === 'Escape'){ clearAll(); e.preventDefault(); return }
    })

    updateDisplay()
  </script>
</body>
</html>
